---
layout: layouts/base.liquid
title: Check for Affordable Housing Updates
permalink: 
  build: "/contrib/affordable-housing/changes/index.html"
pageClass: "smaller max_width"
maxUnits: 6
maxOfferings: 5
maxHouseholdSize: 12
---

{% assign housingFields = housing %}
{% assign unitsFields = units %}

<div class="flex">
  <div class="split">
    <div class="split_left_container">
      <p class="bold">Welcome<span id="welcome-name"></span>!
        <button type="button" class="link" id="edit-user-name" hidden>(Not you?)</button><br/>
        Thanks for helping out.
        <span id="user-name-input-container">
          <label for="user-name-input">What is your name?</label> <input id="user-name-input" type="text"></input>
        </span>
      </p>
      <div class="queue_status">
        <div class="progress_bar flex"><div id="queue-done-bar" class="progress_bar done"></div><div id="queue-in-progress-bar" class="progress_bar partial"></div><div id="queue-to-do-bar" class="progress_bar remaining"></div></div>
        <div class="flex">
          <span class="badge badge__done"><span id="queue-done-val" class="bold">0</span> done</span>
          <span class="badge badge__partial"><span id="queue-in-progress-val" class="bold">0</span> in progress</span>
          <span class="badge badge__remaining"><span id="queue-to-do-val" class="bold">0</span> to-do</span>
        </div>
      </div>
      <h2 id="apt-name-header">Loading property data...</h2>
      <div id="terminal-content"></div>
      <div id="input-content">
        <form id="housing-changes" name="housing_changes" method="POST" action="/contrib/affordable-housing/thank-you" netlify>
        <input type="hidden" id="campaign" name="update_campaign" />
        <input type="hidden" id="user-name" name="user_name" />
          <div id="property-data">
            <input type="hidden" id="{{housingFields.ID.id}}" name="ID" />
            <input type="hidden" id="queue-record-id" name="queue_record_id" />
            {% fieldLabel "Property Name", housingFields, "APT_NAME" %}<br/>
            {% formField housingFields, "APT_NAME", "20em" %}<br/>

            {% fieldLabel "Address", housingFields, "ADDRESS" %}
            <span class="label"><button type="button" id="show-second-address" class="link">Add a second address</button></span><br/>
            {% formField housingFields, "ADDRESS", "20em" %}<br/>
            <div id="second-address" hidden>
            {% fieldLabel "Second address", housingFields, "SECOND_ADDRESS" %}<br/>
            {% formField housingFields, "SECOND_ADDRESS", "20em" %}<br/>
            </div>

            {% fieldLabel "City", housingFields, "CITY" %}<br/>
            {% formField housingFields, "CITY" %}<br/>

            {% fieldLabel "ZIP Code", housingFields, "ZIP_CODE" %}<br/>
            {% formField housingFields, "ZIP_CODE", "6em" %}<br/>

            {% fieldLabel "Contact Phone", housingFields, "PHONE" %}<br/>
            {% formField housingFields, "PHONE", "9em" %}<br/>

            {% fieldLabel "Contact Email", housingFields, "EMAIL" %}<br/>
            {% formField housingFields, "EMAIL", "25em" %}<br/>

            {% fieldLabel "Management Company", housingFields, "MANAGEMENT_COMPANY" %}<br/>
            {% formField housingFields, "MANAGEMENT_COMPANY", "20em" %}<br/>

            {% fieldLabel "URL", housingFields, "PROPERTY_URL" %}
            <a href="" target="_blank" rel="noopener" class="label property-link">Visit this page</a><sup>&#8599;</sup><br/>
            {% formField housingFields, "PROPERTY_URL", "35em" %}<br/>

            {% fieldLabel "Total Units", housingFields, "UNITS_CNT" %}<br/>
            {% formField housingFields, "UNITS_CNT", "5em" %}<br/>

            <div class="multiselect" id="populations-served">
            {% fieldLabel "Populations Served", housingFields, "POPULATIONS_SERVED" %}<br/>
            {% formField housingFields, "POPULATIONS_SERVED" %}<br/>
            </div>

            <div id="min-age" hidden>
            {% fieldLabel "Minimum Resident Age", housingFields, "MIN_RESIDENT_AGE" %}<br/>
            {% formField housingFields, "MIN_RESIDENT_AGE", "4em" %}<br/>
            </div>

            <div id="max-age" hidden>
            {% fieldLabel "Maximum Resident Age", housingFields, "MAX_RESIDENT_AGE" %}<br/>
            {% formField housingFields, "MAX_RESIDENT_AGE", "4em" %}<br/>
            </div>

            {% formField housingFields, "ACCEPTS_VOUCHERS" %}
            {% fieldLabel "Accepts Vouchers", housingFields, "ACCEPTS_VOUCHERS" %}<br/>

            {% formField housingFields, "HAS_WHEELCHAIR_ACCESSIBLE_UNITS" %}
            {% fieldLabel "Wheelchair Accessible Units", housingFields, "HAS_WHEELCHAIR_ACCESSIBLE_UNITS" %}<br/>

            {% formField housingFields, "DISALLOWS_PUBLIC_APPLICATIONS" %}
            {% fieldLabel "Only accepts referral applications", housingFields, "DISALLOWS_PUBLIC_APPLICATIONS" %}<br/>

            {% formField housingFields, "PREFERS_LOCAL_APPLICANTS" %}
            {% fieldLabel "Prefers applicants within the local city", housingFields, "PREFERS_LOCAL_APPLICANTS" %}<br/>
          </div>

          <div id="all-units">
            {% assign unitEndIdx = maxUnits | plus: -1 %}
            {% for unitNum in (0..unitEndIdx) %}
              {% assign unitIdx = unitNum %}
              <div id="unit-{{unitNum}}" class="fieldset_box" hidden>
                <fieldset>
                  <legend><span class="section_title">Unit Type</span>
                    <div class="float_right">
                      <button type="button" class="btn btn_secondary collapse_control">Collapse</button>
                      <button type="button" class="btn btn_warning delete_unit">Delete</button>
                    </div>
                  </legend>
                  <div class="collapsible_content">
                    {% indexedFieldLabel unitIdx, "Type", unitsFields, "TYPE" %}<br/>
                    {% indexedFormField unitIdx, unitsFields, "TYPE" %}<br/>

                    {% indexedFieldLabel unitIdx, "Status", unitsFields, "STATUS" %}<br/>
                    {% indexedFormField unitIdx, unitsFields, "STATUS" %}<br/>

                    {% indexedFieldLabel unitIdx, "Minimum Income", unitsFields, "MIN_INCOME_RENT_FACTOR" %}<br/> 
                    {% indexedFormField unitIdx, unitsFields, "MIN_INCOME_RENT_FACTOR", "5em" %} times yearly rent<br/>

                    <span class="label">Occupancy Limits</span>
                    <span class="tooltip_entry">
                      <span class="icon_query"></span>
                      <span class="tooltip_content">The minimum and maximum number of people allowed to live in this unit.</span>
                    </span>
                    <br/>
                    {% indexedFormField unitIdx, unitsFields, "MIN_OCCUPANCY", "4em" %} to 
                    {% indexedFormField unitIdx, unitsFields, "MAX_OCCUPANCY", "4em" %} people<br/>
                    <div class="all_offerings">
                      {% assign offeringEndIdx = maxOfferings | plus: -1 %}
                      {% for offerNum in (0..offeringEndIdx) %}
                        <div id="unit-{{unitNum}}-offering-{{offerNum}}" class="fieldset_box" hidden>
                        <fieldset>
                          <legend><span class="section_title">Rent Offering</span>
                            <div class="float_right">
                              <button type="button" class="btn btn_secondary collapse_control">Collapse</button>
                              <button type="button" class="btn btn_warning delete_offering">Delete</button>
                            </div>
                          </legend>
                          <div class="collapsible_content">
                            {% assign offerIdx = unitNum | append: ":" | append: offerNum %}
                            <input type="hidden" id={{unitsFields.ID.id}} name={{"ID:" | append: offerIdx}}>
                            {% indexedFieldLabel offerIdx, "Percent AMI", unitsFields, "PERCENT_AMI" %}<br/>
                            {% indexedFormField offerIdx, unitsFields, "PERCENT_AMI", "4em" %}%<br/>

                            {% indexedFieldLabel offerIdx, "Rent", unitsFields, "RENT_PER_MONTH_USD" %}<br/>
                            {% indexedFormField offerIdx, unitsFields, "RENT_PER_MONTH_USD", "5em" %} $/month<br/>

                            <table class="max_income">
                              <tr>
                                <th>Household Size</th>
                                <th>Maximum Income</th>
                              </tr>
                              {% for hhSize in (1..maxHouseholdSize) %}
                                <tr>
                                {% assign fieldname = "MAX_YEARLY_INCOME_HH_" | append: hhSize | append: "_USD" %}
                                {% if hhSize == 1 %}
                                  {% assign hhSizeStr = hhSize | append: " person" %}
                                {% else %}
                                  {% assign hhSizeStr = hhSize | append: " people" %}
                                {% endif %}
                                  <td>{% indexedFieldLabel offerIdx, hhSizeStr, unitsFields, fieldname %}</td>
                                  <td>${% indexedFormField offerIdx, unitsFields, fieldname, "7em" %} per year</td>
                                </tr>
                              {% endfor %}
                            </table>
                          </div>
                        </fieldset>
                        </div>
                      {% endfor %}
                    </div>
                    <button type="button" class="btn btn_secondary add_offering">Add rent offering</button>
                  </div>
                </fieldset>
              </div>
            {% endfor %}
          </div>

          <button type="button" id="add-unit" class="btn btn_secondary">Add unit type</button>

          <br/><br/><label for="user-notes" style="white-space: break-spaces; display: block; width: 30em">Not sure how to input some of this property's information? Need to leave a note for the reviewer? Enter it here.</label>
          <textarea id="user-notes" name="userNotes" style="width: 30em; height: 6em"></textarea>

          <button type="button" id="submit-button-changes" class="btn btn_primary">Submit for review</button>
          <button type="button" id="submit-button-no-changes" class="btn btn_secondary">No changes found</button>
        </form>
      </div>
    </div>
  </div>

  <div class="split sticky">
    <div class="split_right_container">
      <iframe id="property-webpage-frame" src=""></iframe>
    </div>
  </div>
</div>

<script src="/js/affordable-housing-changes.js"></script>
<script>
  run();
</script>